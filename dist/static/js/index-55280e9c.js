import{c as e}from"./_@vue_runtime-dom@3.3.4@@vue-b297d5cc.js";import{E as t}from"./_element-plus@2.3.12@element-plus-1fe65c97.js";import{d as s,r as i,k as o}from"./_@vue_runtime-core@3.3.4@@vue-978ef2cc.js";import{R as n,c as a,a as r}from"./_vue-router@4.2.4@vue-router-a317c40a.js";import{E as c}from"./_@element-plus_icons-vue@1.1.4@@element-plus-01cace4f.js";import{n as d}from"./_el-table-next@1.0.2@el-table-next-8b60d26c.js";import{s as l}from"./_vant@3.6.12@vant-dc8abde3.js";import{d as m,c as h}from"./_pinia@2.1.6@pinia-013071b1.js";import{a as p}from"./_axios@1.5.0@axios-c62df7d0.js";import{m as u}from"./_mitt@3.0.1@mitt-a2488f8e.js";/* empty css                                          */import"./_@vue_shared@3.3.4@@vue-acd024c2.js";import"./_@vue_reactivity@3.3.4@@vue-189719d1.js";import"./_@vueuse_core@9.13.0@@vueuse-0c6e9a97.js";import"./_@vueuse_shared@9.13.0@@vueuse-b2992922.js";import"./_lodash-es@4.17.21@lodash-es-bb6a8ad8.js";import"./_@element-plus_icons-vue@2.1.0@@element-plus-15fdc037.js";import"./_@vant_use@1.6.0@@vant-853d0ae1.js";import"./_@vant_popperjs@1.3.0@@vant-2804c717.js";import"./_vue-demi@0.14.6@vue-demi-f35ceec9.js";!function(){const e=document.createElement("link").relList;if(!(e&&e.supports&&e.supports("modulepreload"))){for(const e of document.querySelectorAll('link[rel="modulepreload"]'))t(e);new MutationObserver((e=>{for(const s of e)if("childList"===s.type)for(const e of s.addedNodes)"LINK"===e.tagName&&"modulepreload"===e.rel&&t(e)})).observe(document,{childList:!0,subtree:!0})}function t(e){if(e.ep)return;e.ep=!0;const t=function(e){const t={};return e.integrity&&(t.integrity=e.integrity),e.referrerpolicy&&(t.referrerPolicy=e.referrerpolicy),"use-credentials"===e.crossorigin?t.credentials="include":"anonymous"===e.crossorigin?t.credentials="omit":t.credentials="same-origin",t}(e);fetch(e.href,t)}}();const f=s({props:{},setup:e=>()=>i("div",{class:"main"},[i(n,null,null)])}),g=s({setup:()=>(o((()=>{})),()=>i(f,null,null))}),v={},_=[{path:"/",redirect:"/mp/home"},{path:"/mp/home",name:"home",component:()=>function(e,t,s){if(!t||0===t.length)return e();const i=document.getElementsByTagName("link");return Promise.all(t.map((e=>{if((e=function(e){return"/"+e}(e))in v)return;v[e]=!0;const t=e.endsWith(".css"),o=t?'[rel="stylesheet"]':"";if(s)for(let s=i.length-1;s>=0;s--){const o=i[s];if(o.href===e&&(!t||"stylesheet"===o.rel))return}else if(document.querySelector(`link[href="${e}"]${o}`))return;const n=document.createElement("link");return n.rel=t?"stylesheet":"modulepreload",t||(n.as="script",n.crossOrigin=""),n.href=e,document.head.appendChild(n),t?new Promise(((t,s)=>{n.addEventListener("load",t),n.addEventListener("error",(()=>s(new Error(`Unable to preload CSS for ${e}`))))})):void 0}))).then((()=>e()))}((()=>import("./home-916a5886.js")),["static/js/home-916a5886.js","static/js/_vue3-markdown-it@1.0.10@vue3-markdown-it-dd5e72b7.js","static/js/_clipboard@2.0.11@clipboard-eaf614d7.js","static/js/_vue@3.3.4@vue-c91821cd.js","static/js/_@vue_runtime-dom@3.3.4@@vue-b297d5cc.js","static/js/_@vue_runtime-core@3.3.4@@vue-978ef2cc.js","static/js/_@vue_reactivity@3.3.4@@vue-189719d1.js","static/js/_@vue_shared@3.3.4@@vue-acd024c2.js","static/js/_process@0.11.10@process-fb5a350b.js","static/js/_vue-clipboard3@2.0.0@vue-clipboard3-be4c93a6.js","static/js/_vant@3.6.12@vant-dc8abde3.js","static/js/_@vant_use@1.6.0@@vant-853d0ae1.js","static/js/_@vant_popperjs@1.3.0@@vant-2804c717.js","static/css/_vant@3.6-80052542.css","static/js/_element-plus@2.3.12@element-plus-1fe65c97.js","static/js/_@vueuse_core@9.13.0@@vueuse-0c6e9a97.js","static/js/_@vueuse_shared@9.13.0@@vueuse-b2992922.js","static/js/_lodash-es@4.17.21@lodash-es-bb6a8ad8.js","static/js/_@element-plus_icons-vue@2.1.0@@element-plus-15fdc037.js","static/css/_element-plus@2.3-9378beab.css","static/js/_vue-router@4.2.4@vue-router-a317c40a.js","static/js/_@element-plus_icons-vue@1.1.4@@element-plus-01cace4f.js","static/js/_el-table-next@1.0.2@el-table-next-8b60d26c.js","static/js/_pinia@2.1.6@pinia-013071b1.js","static/js/_vue-demi@0.14.6@vue-demi-f35ceec9.js","static/js/_axios@1.5.0@axios-c62df7d0.js","static/js/_mitt@3.0.1@mitt-a2488f8e.js","static/css/home-5bda9874.css","static/css/_highlight.js@11.8.0@highlight-f02ba415.css"]),meta:{title:"首页",key:"/cms/home"}}],b=a({history:r(),routes:_}),j=p.create({baseURL:"/api/v1",withCredentials:!0,timeout:111115e3});j.interceptors.request.use((e=>("/file/uploadFile"==e.url&&(e.headers["Content-Type"]="multipart/form-data"),e.headers["Content-Type"]="application/json",e)),(e=>Promise.reject(e))),j.interceptors.response.use((e=>(e.data,e.data)),(e=>(403!==e.response.status&&e.response.data.msg&&t.error(e.response?e.response.data.msg||e.response.statusText:"服务器断开连接，cancel"),"REDIRECT"===e.response.headers.redirect&&(window.location.href=e.response.headers.contentpath),Promise.reject(e))));const w=m("data",{state:()=>({title:"AI Chat",tabId:null,session:[],message:null,navList:[],loading:!1,updateTime:"",netErr:!1}),actions:{ActiveChat(e){this.tabId=e,this.GetChat()},GetChat(){var e;(e={id:this.tabId},j({url:"https://jetbra.top/api/v1/ai/chat",method:"get",params:e})).then((e=>{this.message=e.chat}))},GetChats(){var e;(e={until:this.updateTime||+new Date},j({url:"https://jetbra.top/api/v1/ai/chats",method:"get",params:e})).then((e=>{if(e.chats&&(this.navList=[...this.navList,...e.chats]),!e.chats)return this.CreateMessage();this.updateTime=this.navList[this.navList.length-1].update_time,this.tabId||(this.tabId=this.navList[0].id,this.updateTime=this.navList[this.navList.length-1].update_time,this.GetChat())}))},SenMsg(e){var t;e&&(this.message.messages.push({role:"user",content:e}),this.message.messages.push({role:"assistant",content:""}),this.loading=!0,this.netErr=!1,(t={message:e,id:this.tabId},j({url:"https://jetbra.top/api/v1/ai/chat",method:"post",data:t})).then((e=>{this.message.messages[this.message.messages.length-1].content=e.message.content,this.loading=!1,this.tabId||(this.tabId=e.id,this.GetChats())})).catch((e=>{this.message.messages[this.message.messages.length-1].content="发送失败，请稍后重试",this.loading=!1,this.netErr=!1})))},SenMsgAlgin(){},CreateMessage(){this.tabId=null,this.message={messages:[]},this.message.messages.push({role:"assistant",content:"您好，我是AI，有什么可以帮助您的"})},DeleteItem(e){var t;(t={id:e},j({url:"https://jetbra.top/api/v1/ai/chat",method:"delete",params:t})).then((e=>{this.navList=[],this.updateTime="",this.tabId=null,this.GetChats()}))}}});b.beforeEach((async(e,t,s)=>{const i=w();if(/micromessenger/.test(navigator.userAgent.toLowerCase())){const e=window.location.href,t=localStorage.getItem("token");if(e.includes("?code")){const t=e.split("?code=")[1].split("&state")[0];localStorage.setItem("token",t);var o=window.location.protocol+"//"+window.location.host+"/#/mp/home";return window.history.pushState({},0,o),i.GetChats(),s()}if(t)return i.GetChats(),s();(()=>{const e=`https://open.weixin.qq.com/connect/oauth2/authorize?appid=wx10cede6667d6d736&redirect_uri=${encodeURIComponent("https://jetbra.top/")}&response_type=code&scope=snsapi_userinfo&state=STATE#wechat_redirect`;window.location.href=e})()}i.GetChats(),s()}));const y=Object.freeze(Object.defineProperty({__proto__:null,switchNav:function(){let e=!1;var t,s={trident:(t=navigator.userAgent).indexOf("Trident")>-1,presto:t.indexOf("Presto")>-1,webKit:t.indexOf("AppleWebKit")>-1,gecko:t.indexOf("Firefox")>-1,mobile:!!t.match(/AppleWebKit.*Mobile.*/),ios:!!t.match(/\(i[^;]+;( U;)? CPU.+Mac OS X/),android:t.indexOf("Android")>-1||t.indexOf("Linux")>-1,iPhone:t.indexOf("iPhone")>-1,iPad:t.indexOf("iPad")>-1,webApp:t.indexOf("Safari")>-1};return(s.mobile||s.ios||s.android||s.iPhone||s.iPad)&&(e=!0),e}},Symbol.toStringTag,{value:"Module"}));function C(){const e=document.documentElement.clientWidth/375;document.documentElement.style.fontSize=37.5*Math.min(e,2)+"px"}C(),window.onresize=function(){C()};const x=e(g);x.config.globalProperties.$mitt=u();for(const[E,I]of Object.entries(c))x.component(E,I);x.config.globalProperties.$func=y,x.use(h()),x.use(l),x.use(d),x.use(b),x.mount("#app");export{w as u};
