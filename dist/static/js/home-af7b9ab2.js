import{M as e}from"./_vue3-markdown-it@1.0.10@vue3-markdown-it-f66366d0.js";import{u as t}from"./index-ad672298.js";import{d as a,r as l,E as s,K as n,k as i,n as o,ae as u,o as r,c,a as d,w as m}from"./_@vue_runtime-core@3.3.4@@vue-69185d8f.js";import{r as v,a as p}from"./_@vue_reactivity@3.3.4@@vue-c0367d69.js";import{b as g}from"./_process@0.11.10@process-fb5a350b.js";import{n as h}from"./_@vue_runtime-dom@3.3.4@@vue-7223771d.js";import{r as f}from"./_@vue_shared@3.3.4@@vue-5a722e92.js";import{c as b}from"./_vue-clipboard3@2.0.0@vue-clipboard3-be4c93a6.js";import{T as w}from"./_vant@3.6.12@vant-2fdc3f03.js";import"./_clipboard@2.0.11@clipboard-eaf614d7.js";import"./_vue@3.3.4@vue-ba896a43.js";/* empty css                                          */import"./_vue-router@4.2.4@vue-router-031641e8.js";import"./_@element-plus_icons-vue@1.1.4@@element-plus-b55c0ed2.js";import"./_el-table-next@1.0.2@el-table-next-45c158e9.js";import"./_pinia@2.1.6@pinia-408d9fd4.js";import"./_vue-demi@0.14.6@vue-demi-f35ceec9.js";import"./_axios@1.5.0@axios-c62df7d0.js";import"./_mitt@3.0.1@mitt-a2488f8e.js";/* empty css                                          */import"./_@vant_use@1.6.0@@vant-e14af15e.js";import"./_@vant_popperjs@1.3.0@@vant-2804c717.js";const _="/static/svg/loading-b3ddb28b.svg",j=a({props:{},setup(e,a){const i=t(),o=v(!1),u=()=>{o.value=!o.value};return a.expose({tabStatus:u}),()=>l(s("van-popup"),{show:o.value,"onUpdate:show":e=>o.value=e,position:"right",style:{width:"70%",height:"100%"}},{default:()=>[l("div",{class:"main-popup"},[l("div",{class:"data-header"},[l("span",{class:"add-button",onClick:()=>{i.CreateMessage(),u()}},[n(" + 创建新对话")])]),l("div",{class:"data-view"},[l("ul",null,[i.navList.length?i.navList.map(((e,t)=>l("li",{key:t,class:1*e.id==1*i.tabId&&"active",onClick:()=>{(e=>{i.tabId!=e&&(i.ActiveChat(e),u())})(e.id)}},[e.title||"New Chat",n(" "),1*e.id==1*i.tabId&&l("img",{onClick:()=>{var t;t=e.id,i.DeleteItem(t)},src:"/static/svg/del-c011473b.svg",alt:""},null)]))):null]),l("span",{class:"more",onClick:()=>{i.GetChats()}},[n("加载更多...")])]),l("div",{class:"data-bottom"},null)])]})}}),y=(e,t)=>{const a=e.__vccOpts||e;for(const[l,s]of t)a[l]=s;return a},H=a({name:"DragBall",components:{},props:{distanceRight:{type:Number,default:10},distanceBottom:{type:Number,default:300},isScrollHidden:{type:Boolean,default:!1},isCanDraggable:{type:Boolean,default:!0}},emits:["handlepaly"],setup(e,{emit:t}){const a=p({clientWidth:null,clientHeight:null,left:0,top:0,right:0,timer:null,currentTop:0,mousedownX:0,mousedownY:0}),l=v(),s=v(null);a.clientWidth=document.documentElement.clientWidth,a.clientHeight=document.documentElement.clientHeight,i((()=>{e.isCanDraggable&&o((()=>{var t;l.value=document.getElementById("floatDrag"),a.right=e.distanceRight,a.top=Number(a.clientHeight)-(null==(t=l.value)?void 0:t.offsetHeight)-e.distanceBottom,n()}));const t=localStorage.getItem("user"),i=t&&JSON.parse(t);i.value=i?i.avatar:null,s.value=i.value||"/static/svg/Nav-ace25b3b.svg",window.addEventListener("resize",r)})),u((()=>{window.removeEventListener("resize",r)}));const n=()=>{l.value.addEventListener("touchstart",m),l.value.addEventListener("touchmove",(e=>g(e))),l.value.addEventListener("touchend",h)},r=()=>{c()},c=()=>{a.clientWidth=document.documentElement.clientWidth,a.clientHeight=document.documentElement.clientHeight,a.right+l.value.offsetWidth/2>=a.clientWidth/2?a.right=a.clientWidth-l.value.offsetWidth:a.right=0,a.top<0&&(a.top=0),a.top+l.value.offsetHeight>=a.clientHeight&&(a.top=a.clientHeight-l.value.offsetHeight)},d=v(!1),m=()=>{d.value=!1,l.value.style.transition="none"},g=e=>{if(d.value=!0,1===e.targetTouches.length){let t=e.targetTouches[0];a.right=Number(a.clientWidth)-t.clientX-l.value.offsetWidth/2,a.top=t.clientY-l.value.offsetHeight/2}},h=()=>{d.value&&(l.value.style.transition="all 0.3s",c())};return{data:a,handleResize:r,checkDraggablePosition:c,mouseUp:e=>{const s=e||window.event;a.mousedownY==s.screenY&&a.mousedownX==s.screenX&&t("handlepaly"),document.onmousemove=null,c(),l.value.style.transition="all 0.3s"},mouseDown:t=>{const s=t||window.event;a.mousedownX=s.screenX,a.mousedownY=s.screenY;let n=l.value.offsetWidth/2,i=l.value.offsetHeight/2;s.preventDefault&&s.preventDefault(),d.value=!1,l.value.style.transition="none",document.onmousemove=function(t){var s,o=t||window.event;if(a.right=Number(a.clientWidth)-o.clientX-n,a.top=o.clientY-i,a.right<0&&(a.right=0),a.top<0&&(a.top=0),o.clientY<0||o.clientY>Number(a.clientHeight)||o.clientX>Number(a.clientWidth)||o.clientX<0)return a.right=0,a.top=Number(a.clientHeight)-(null==(s=l.value)?void 0:s.offsetHeight)-e.distanceBottom,document.onmousemove=null,void(l.value.style.transition="all 0.3s");a.right>=document.documentElement.clientWidth-2*n&&(a.right=document.documentElement.clientWidth-2*n),a.top>=Number(a.clientHeight)-2*i&&(a.top=Number(a.clientHeight)-2*i)}},avatar:s}}}),k={class:"content"},C=["src"];const W=y(H,[["render",function(e,t,a,l,s,n){return r(),c("div",{ref:"floatDrag",id:"floatDrag",class:"float-position",style:f({top:e.data.top+"px",right:e.data.right+"px !important"}),onTouchmove:t[0]||(t[0]=h((()=>{}),["prevent"])),onMousemove:t[1]||(t[1]=h((()=>{}),["prevent"])),onMousedown:t[2]||(t[2]=(...t)=>e.mouseDown&&e.mouseDown(...t)),onMouseup:t[3]||(t[3]=(...t)=>e.mouseUp&&e.mouseUp(...t))},[d("div",k,[d("img",{src:e.avatar,alt:""},null,8,C)])],36)}],["__scopeId","data-v-0d3d0cf0"]]),x=a({props:{},setup(a){const o=t(),u=v(""),r=v(null),c=v(null),{toClipboard:d}=b(),p=()=>{let e=document.querySelectorAll("#main ul>li"),t=e[e.length-1];t&&(document.querySelector("#main").scrollTop=t.offsetTop+t.offsetHeight)};m((()=>o.message),(e=>{g.exports.nextTick((()=>{o.message&&o.message.messages.length&&p()}))}),{deep:!0,immediate:!0}),i((()=>{const e=localStorage.getItem("user"),t=e&&JSON.parse(e);t.value=t||null,document.title=t?"Hello！"+t.username:"AI Chat"}));return()=>l("div",{class:"wrapper"},[l(j,{ref:r},null),l("div",{class:"box"},[l("header",null,null),l("main",{id:"main"},[l("ul",null,[o.message&&o.message.messages.map(((t,a)=>"user"===t.role?l("li",{key:a,class:t.role},[l("div",{class:"wrap"},[l("div",{class:"info"},[l("span",null,[n(" 用户 ")]),l("div",{class:"pix"},[l("img",{src:"/static/svg/user-d673dfc5.svg",alt:""},null)])]),l("div",{class:"mark"},[l(e,{source:t.content},null)])])]):l("li",{key:a,class:t.role},[l("div",{class:"wrap"},[l("div",{class:"info"},[l("div",{class:"pix"},[l("img",{src:"/static/svg/ie-ChatGPT-8a3a8eb9.svg",alt:""},null)]),l("span",null,[n("AI Chat")])]),l("div",{class:"mark"},[a+1===o.message.messages.length&&o.loading?l("span",{class:"think"},[n("努力思考中... "),l("img",{src:_,alt:""},null)]):l(e,{source:t.content},null),!!a&&l(s("van-divider"),null,null),a&&!o.loading?o.netErr?l("img",{src:_,alt:"",onClick:()=>{}},null):l("img",{onClick:()=>{(async e=>{try{await d(e),w({message:"复制成功",position:"top"})}catch(t){w({message:"复制失败",position:"top"})}})(t.content)},src:"/static/svg/copy-0b87b716.svg",alt:""},null):""])])])))])]),l("footer",null,[l(s("van-search"),{modelValue:u.value,"onUpdate:modelValue":e=>u.value=e,showAction:!0,placeholder:"您的问题...",onSearch:"onSearch"},{action:l("div",{onClick:()=>{o.SenMsg(u.value),u.value="",setTimeout((()=>{p()}),100)}},[l(s("van-button"),{disabled:o.loading,type:"primary",size:"small"},{default:()=>[o.loading?"思考中":"发送"]})])})])]),l(W,{onClick:()=>{r.value.tabStatus()},avatar:c.avatar},null)])}});export{x as default};
