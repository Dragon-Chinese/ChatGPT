import{M as e}from"./_vue3-markdown-it@1.0.10@vue3-markdown-it-dd5e72b7.js";import{u as t}from"./index-55280e9c.js";import{d as s,r as a,E as i,Q as o,k as l,n,ai as u,o as c,c as r,ao as d,an as m,a as v,w as p}from"./_@vue_runtime-core@3.3.4@@vue-978ef2cc.js";import{r as g,a as h}from"./_@vue_reactivity@3.3.4@@vue-189719d1.js";import{b as f}from"./_process@0.11.10@process-fb5a350b.js";import{w as b}from"./_@vue_runtime-dom@3.3.4@@vue-b297d5cc.js";import{r as _}from"./_@vue_shared@3.3.4@@vue-acd024c2.js";import{c as w}from"./_vue-clipboard3@2.0.0@vue-clipboard3-be4c93a6.js";import{T as j}from"./_vant@3.6.12@vant-dc8abde3.js";import"./_clipboard@2.0.11@clipboard-eaf614d7.js";import"./_vue@3.3.4@vue-c91821cd.js";import"./_element-plus@2.3.12@element-plus-1fe65c97.js";import"./_@vueuse_core@9.13.0@@vueuse-0c6e9a97.js";import"./_@vueuse_shared@9.13.0@@vueuse-b2992922.js";import"./_lodash-es@4.17.21@lodash-es-bb6a8ad8.js";import"./_@element-plus_icons-vue@2.1.0@@element-plus-15fdc037.js";import"./_vue-router@4.2.4@vue-router-a317c40a.js";import"./_@element-plus_icons-vue@1.1.4@@element-plus-01cace4f.js";import"./_el-table-next@1.0.2@el-table-next-8b60d26c.js";import"./_pinia@2.1.6@pinia-013071b1.js";import"./_vue-demi@0.14.6@vue-demi-f35ceec9.js";import"./_axios@1.5.0@axios-c62df7d0.js";import"./_mitt@3.0.1@mitt-a2488f8e.js";/* empty css                                          */import"./_@vant_use@1.6.0@@vant-853d0ae1.js";import"./_@vant_popperjs@1.3.0@@vant-2804c717.js";const y="/static/svg/loading-b3ddb28b.svg",H=s({props:{},setup(e,s){const l=t(),n=g(!1),u=()=>{n.value=!n.value};return s.expose({tabStatus:u}),()=>a(i("van-popup"),{show:n.value,"onUpdate:show":e=>n.value=e,position:"right",style:{width:"70%",height:"100%"}},{default:()=>[a("div",{class:"main-popup"},[a("div",{class:"data-header"},[a("span",{class:"add-button",onClick:()=>{l.CreateMessage(),u()}},[o(" + 创建新对话")])]),a("div",{class:"data-view"},[a("ul",null,[l.navList.length?l.navList.map(((e,t)=>a("li",{key:t,class:1*e.id==1*l.tabId&&"active",onClick:()=>{(e=>{l.tabId!=e&&(l.ActiveChat(e),u())})(e.id)}},[e.abstract||"New Chat",o(" "),1*e.id==1*l.tabId&&a("img",{onClick:()=>{var t;t=e.id,l.DeleteItem(t)},src:"/static/svg/del-c011473b.svg",alt:""},null)]))):null]),a("span",{class:"more",onClick:()=>{l.GetChats()}},[o("加载更多...")])]),a("div",{class:"data-bottom"},[a("p",{class:"tips"},[o("登录后可自动同步设备聊天记录")])])])]})}}),k=(e,t)=>{const s=e.__vccOpts||e;for(const[a,i]of t)s[a]=i;return s},C=s({name:"DragBall",components:{},props:{distanceRight:{type:Number,default:10},distanceBottom:{type:Number,default:70},isScrollHidden:{type:Boolean,default:!1},isCanDraggable:{type:Boolean,default:!0}},emits:["handlepaly"],setup(e,{emit:t}){const s=h({clientWidth:null,clientHeight:null,left:0,top:0,right:0,timer:null,currentTop:0,mousedownX:0,mousedownY:0}),a=g();s.clientWidth=document.documentElement.clientWidth,s.clientHeight=document.documentElement.clientHeight,l((()=>{e.isCanDraggable&&n((()=>{var t;a.value=document.getElementById("floatDrag"),s.right=e.distanceRight,s.top=Number(s.clientHeight)-(null==(t=a.value)?void 0:t.offsetHeight)-e.distanceBottom,i()})),window.addEventListener("resize",o)})),u((()=>{window.removeEventListener("resize",o)}));const i=()=>{a.value.addEventListener("touchstart",d),a.value.addEventListener("touchmove",(e=>m(e))),a.value.addEventListener("touchend",v)},o=()=>{c()},c=()=>{s.clientWidth=document.documentElement.clientWidth,s.clientHeight=document.documentElement.clientHeight,s.right+a.value.offsetWidth/2>=s.clientWidth/2?s.right=s.clientWidth-a.value.offsetWidth:s.right=0,s.top<0&&(s.top=0),s.top+a.value.offsetHeight>=s.clientHeight&&(s.top=s.clientHeight-a.value.offsetHeight)},r=g(!1),d=()=>{r.value=!1,a.value.style.transition="none"},m=e=>{if(r.value=!0,1===e.targetTouches.length){let t=e.targetTouches[0];s.right=Number(s.clientWidth)-t.clientX-a.value.offsetWidth/2,s.top=t.clientY-a.value.offsetHeight/2}},v=()=>{r.value&&(a.value.style.transition="all 0.3s",c())};return{data:s,handleResize:o,checkDraggablePosition:c,mouseUp:e=>{const i=e||window.event;s.mousedownY==i.screenY&&s.mousedownX==i.screenX&&t("handlepaly"),document.onmousemove=null,c(),a.value.style.transition="all 0.3s"},mouseDown:t=>{const i=t||window.event;s.mousedownX=i.screenX,s.mousedownY=i.screenY;let o=a.value.offsetWidth/2,l=a.value.offsetHeight/2;i.preventDefault&&i.preventDefault(),r.value=!1,a.value.style.transition="none",document.onmousemove=function(t){var i,n=t||window.event;if(s.right=Number(s.clientWidth)-n.clientX-o,s.top=n.clientY-l,s.right<0&&(s.right=0),s.top<0&&(s.top=0),n.clientY<0||n.clientY>Number(s.clientHeight)||n.clientX>Number(s.clientWidth)||n.clientX<0)return s.right=0,s.top=Number(s.clientHeight)-(null==(i=a.value)?void 0:i.offsetHeight)-e.distanceBottom,document.onmousemove=null,void(a.value.style.transition="all 0.3s");s.right>=document.documentElement.clientWidth-2*o&&(s.right=document.documentElement.clientWidth-2*o),s.top>=Number(s.clientHeight)-2*l&&(s.top=Number(s.clientHeight)-2*l)}}}}}),W=[(e=>(d("data-v-6f5e4fa4"),e=e(),m(),e))((()=>v("div",{class:"content"},[v("img",{src:"/static/svg/Nav-ace25b3b.svg",alt:""})],-1)))];const x=k(C,[["render",function(e,t,s,a,i,o){return c(),r("div",{ref:"floatDrag",id:"floatDrag",class:"float-position",style:_({top:e.data.top+"px",right:e.data.right+"px !important"}),onTouchmove:t[0]||(t[0]=b((()=>{}),["prevent"])),onMousemove:t[1]||(t[1]=b((()=>{}),["prevent"])),onMousedown:t[2]||(t[2]=(...t)=>e.mouseDown&&e.mouseDown(...t)),onMouseup:t[3]||(t[3]=(...t)=>e.mouseUp&&e.mouseUp(...t))},W,36)}],["__scopeId","data-v-6f5e4fa4"]]),E=s({props:{},setup(s){const n=t(),u=g(""),c=g(null),{toClipboard:r}=w(),d=()=>{let e=document.querySelectorAll("#main ul>li"),t=e[e.length-1];t&&(document.querySelector("#main").scrollTop=t.offsetTop+t.offsetHeight)};p((()=>n.message),(e=>{f.exports.nextTick((()=>{n.message&&n.message.messages.length&&d()}))}),{deep:!0,immediate:!0}),l((()=>{}));return()=>a("div",{class:"wrapper"},[a(H,{ref:c},null),a("div",{class:"box"},[a("header",null,null),a("main",{id:"main"},[a("ul",null,[n.message&&n.message.messages.map(((t,s)=>"user"===t.role?a("li",{key:s,class:t.role},[a("div",{class:"wrap"},[a("div",{class:"info"},[a("span",null,[o(" 用户 ")]),a("div",{class:"pix"},[a("img",{src:"/static/svg/user-d673dfc5.svg",alt:""},null)])]),a("div",{class:"mark"},[a(e,{source:t.content},null)])])]):a("li",{key:s,class:t.role},[a("div",{class:"wrap"},[a("div",{class:"info"},[a("div",{class:"pix"},[a("img",{src:"/static/svg/ie-ChatGPT-8a3a8eb9.svg",alt:""},null)]),a("span",null,[o("AI Chat")])]),a("div",{class:"mark"},[s+1===n.message.messages.length&&n.loading?a("span",{class:"think"},[o("努力思考中... "),a("img",{src:y,alt:""},null)]):a(e,{source:t.content},null),a(i("van-divider"),null,null),n.loading?"":n.netErr?a("img",{src:y,alt:"",onClick:()=>{}},null):a("img",{onClick:()=>{(async e=>{try{await r(e),j({message:"复制成功",position:"top"})}catch(t){j({message:"复制失败",position:"top"})}})(t.content)},src:"/static/svg/copy-0b87b716.svg",alt:""},null)])])])))])]),a("footer",null,[a(i("van-search"),{modelValue:u.value,"onUpdate:modelValue":e=>u.value=e,showAction:!0,placeholder:"您的问题...",onSearch:"onSearch"},{action:a("div",{onClick:()=>{n.SenMsg(u.value),u.value="",setTimeout((()=>{d()}),100)}},[a(i("van-button"),{disabled:n.loading,type:"primary",size:"small"},{default:()=>[n.loading?"思考中":"发送"]})])})])]),a(x,{onClick:()=>{c.value.tabStatus()}},null)])}});export{E as default};
